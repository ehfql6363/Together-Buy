# SSAFY 공통 프로젝트 1주차
## 01.13 1일차
아직 아이디어가 픽스되진 않았지만, 하고 싶은 아이디어로는 1대1 화상 채팅과 1대N 실시간 스트리밍 방식의 기능을 구현하여 중고 거래 시 1대1 화상 채팅과 스트리밍을 활용한 온라인 경매장이다.
OpenVidu라이브러리 사용을 지양하고 직접 라이브러리의 기능들을 구현하는 방식으로 개발하면서 화상 채팅 및 스트리밍의 구조와 원리를 이해하고 싶었다.

우선, 최대한 Java로 개발하고 싶었다. 그런데 조금만 찾아봐도 Java는 라이브 스트리밍에 최선의 선택이 아니라는 것을 알게 되었고, 프로젝트의 방향성에 대해 고민해 봐야 겠다는 결론이 나왔다.

머리 부여잡으면서 새롭게 나온 아이디어는 `공동구매`이다.
우리 조는 주제를 먼저 정하기보다 구현하고 싶은 기술/기능을 먼저 선택했다. 그리고 그 기능은 공동구매로 결정되었고, 이를 구현하기 위해 PG사 API 기반의 결제 시스템을 활용하기로 했다.

하지만, 이 아이디어가 나온 시간은 오후 5시가 넘은 다소 늦은 시간이었으며 다들 이후에 스터디와 같은 일정이 있어서 구체적인 시퀀스 다이어 그램은 다음 날 끝내기로 했다.

---
## 01.14 2일차
`공동 구매`라는 대주제를 기준으로 아이디어 구체화를 진행하고자 한다. 아침 일찍 멀캠에 도착해서 Jira로 이슈를 정리하고 오늘 반드시 해야할 이슈와 가능하다면 해야 하는 일로 나누어 정리했다.
![](https://velog.velcdn.com/images/ehfql6363/post/d786c27b-d928-4c9e-9f7c-7b465c77d257/image.png)

사실, Jira를 이번에 처음 써본 거라 제대로 사용하고 있는지는 모르겠다.

우리 조는 `기획`이라는 스프린트안에 아이디어 구체화에 필요한 여러 이슈를 세분화 했다. `아이디어 회의` 이슈에는 32의 스토리 포인트(1포인트 당 시간으로 설정했다)를 설정하여 그 안에 `공동 구매 아이디어 구체화`, `사용자 역할 별 정리`라는 작업으로 세분화 했고 각각 8포인트, 2포인트씩 할당했다. 오늘 `공동 구매 아디이어 구체화` 작업을 끝내고 싶었다.

일반적인 공동 구매에서 조금 더 차별화를 두어, `지역 커뮤니티 기반 분할 구매`서비스 이다.

### 핵심기능
**1. 공동 구매 / 분할 결제 시스템**<br>
판매자가 올린 대용량 상품을 공동 구매 및 분할하여 소비자끼리 원하는 수량만큼 분할 결제하는 시스템이다. 판매자가 상품을 등록할 때, 분할 할 수 있는 최소 단위를 기입하여 소비자들이 분할하기 편하게 한다.

**2. 커뮤니티 게시판 및 채팅 시스템**<br>
`일반` 커뮤니티 게시판과 `공구` 게시판으로 나누어진다. 일반적인 커뮤니티 게시판과 다르게, `공구` 게시판의 경우 공동 구매를 주도하는 사람(이하 총대)이 공동 구매를 모집하는 글이다. 해당 게시글에는 공구하려는 상품의 정보를 확인할 수 있으며 그룹 채팅에 참여하여 소통할 수 있고, 공동 구매에 참여를 할 수 있다.
공동 구매를 참여하는 방법에는 총 2가지가 있는데, 하나는 상품 탭에서 참여하는 방식과 게시글에서 참여하는 방식으로 공동 구매를 이용할 수 있다.
공동 구매 이용시 원하는 한정된 수량 내에 소비자가 원하는 수량을 입력하면 자동으로 결제할 포인트가 나타나며 선 결제로 공동 구매에 참여할 수 있다.
인원이 모두 모인다면 공동 구매 게시글에 배송을 담당할 사람을 선정한다. 배송하는 사람은 멤버십 점수에 가산점을 부여한다.

**3. 할인, 적립을 할 수 있는 멤버십 시스템**<br>
공동 구매 시스템을 장려하기 위한 멤버십 기반 할인 및 적립 시스템이다. 총대와 일반 소비자는 같은 멤버십 점수를 가져가지만 물리적으로 배송을 해야하는 점을 고려하여 배송을 담당하는 사용자는 멤버십 점수에 가산점을 부여한다.
할인은 선 결제를 하는 과정에서 할인 금액 및 비율만큼 차감되어 결제를 할 수 있다.
적립은 공동 구매 이용시 멤버십 등급 비율 기준으로 이용한 금액에서 적립된다.

**4. 추천 시스템**<br>
구매자의 성향에 맞게 상품을 추천하는 기능이다. 사용자 기반 추천 시스템으로 구상 중이다. (현재 data가 부족할 때의 솔루션을 고민하고 있다.)

![](https://velog.velcdn.com/images/ehfql6363/post/b1f2ee54-f1dc-4020-bc14-f5735fd05096/image.png)

이러한 핵심 기능들을 약 6주라는 기간동안 개발해야 한다. 우선 순위는 번호 순서대로 가져갈 생각이다.

핵심 기능을 구상한 김에 사용자 역할 별 서비스 시퀀스를 구상하기로 했다. 사용자 역할은 구매자, 판매자, 관리자로 나누어졌으며, 시간 관계상 구매자 시퀀스만 구상하였다.

![](https://velog.velcdn.com/images/ehfql6363/post/5dfdd2e4-2c75-46bb-b3ff-60e0a3b78414/image.png)

---
## 01.15 3일차
오늘은 사용자 역할 중 판매자와 관리자 시퀀스를 구상하는 날이다.
시작하기에 앞서 어제 했던 내용을 리마인드하면서 서로 이해하는 방향을 맞추는 시간을 가졌다.

오늘도 오전에 팀장 미팅 및 PM 특강으로 오후에 `판매자`, `관리자` 시퀀스를 정했다.

판매자는 다음과 같은 과정을 거칠 수 있다.
![](https://velog.velcdn.com/images/ehfql6363/post/c0668a01-c886-4e0e-a046-e9f8c579106f/image.png)

조금 풀어서 설명하자면, 판매자는 판매자 계정을 따로 만들지 않고 일반 계정에서 판매자 전환을 통해 판매 행위를 할 수 있다. 우리 서비스에서는 이를 `비즈니스 전환`이라고 표현하고 있다.
비즈니스 전환을 시도할 경우 비즈니스 전환 페이지를 통해 전환이 가능하다.

비즈니스 전환에 성공한 계정은 자동으로 비즈니스 메인 페이지로 리다이렉트 되는데, Web 레이아웃으로 제공된다. 우리 서비스는 구매자와 판매자(및 관리자)가 보는 레이아웃이 다른데 구매자는 앱, 판매자는 웹 화면을 보여줄 예정이다. 물론, 웹과 앱 둘 다 개발할 수 있다면 좋지만 현실적으로 6인 중 2인이 프론트엔드를 담당하기 때문에 어려울 것 같다는 생각을 했다. 그래서 각 사용자 역할 별로 가장 많이 이용할 것 같은 것을 기준으로 선택했다.

판매자는 비즈니스 메인 페이지에서 등록된 다른 상품을 볼 수 있다.
해당 페이지에는 상품을 등록하는 버튼을 통해 상품을 등록할 수 있다. 기본적인 **이름**과 **상품 상세**, **이미지** 등을 입력할 수 있고 해당 상품을 구매하기 위한 **전체 금액**과 **소분할 수 있는 최소 단위** 및 **단위 금액**을 설정할 수 있다.

판매자는 대시보드를 통해 상품과 배송을 관리하고 정산 상황을 시각적으로 확인할 수 있다.
정산 상황은 금월을 포함한 모든 달에 대한 거래 내역과 정산 금액을 확인할 수 있다. 최종 정산은 판매자가 비즈니스 전환 페이지에서 입력한 정산일에 계산되어 진행된다.

관리자는 다음과 같다.
![](https://velog.velcdn.com/images/ehfql6363/post/169aad2f-1862-406b-8293-02d76c1da6db/image.png)

음...너무 대충한 것처럼 생략된 부분이 많지만, 설명하자면
관리자는 아이디로 구분되며, 관리자로 로그인 할 경우 관리자 페이지로 즉시 넘어간다.
관리자 페이지에는 `유저 관리`, `쿠폰 관리`, `포인트 관리`로 구성되어 있다.
쿠폰 관리에서는 쿠폰의 전체 개수와 사용한 개수를 확인할 수 있다.
포인트 관리는 유저가 충전한 총 금액과 사용된 거래 내역을 관리하고 시각적으로 확인할 수 있다. (각 세부 거래 내용은 유저 관리 페이지에서 확인할 수 있다.)

이렇게 모든 사용자 역할 별로 플로우를 결정했다. 실제로 사용하기에 미흡한 부분이 정말 많지만, 기획부터 테스트까지 6주라는 정해진 기간과 개발 인력 등을 고려하여 핵심 적인 기능과 프로젝트 컬러에 초점을 두었다. 이후, 특화 프로젝트에서 특화 기술을 배우고 적용하여 디벨롭하는 그림을 그릴 수 있을 것 같다.

이제 내일부터 와이어프레임으로 화면 레이아웃과 버튼 등을 그려보고 이를 통해 API 명세서, 엔티티 설계를 진행할 예정이다.

---
## 01.16 4일차
오늘은 각 역할을 분담하고 프론트엔드는 와이어 프레임, 백엔드는 핵심 기능 구체화를 진행했다.

오전에는 사용자 역할 별 시퀀스를 기준으로 UseCase를 텍스트로 작성했다.
![](https://velog.velcdn.com/images/ehfql6363/post/7ec1727f-df37-4708-81af-32c10f58ccd6/image.png)

그리고 오후 1시 반부터 컨설턴트님, 코치님들과 팀 미팅을 잡았다.
팀 미팅 때는 우리 서비스의 핵심 기능 중 결제 기능에 대한 조언을 구했다.
결제 시스템을 포트원와 같은 API를 가져다 쓰면 기술적으로 큰 메리트가 없다고 판단했다. 그래서 우리 서비스와 외부 API의 의존성을 줄이고자 노력했고, 의존성을 줄이는 시나리오 몇 가지 생각했다.

### 외부 API 의존성 줄이기
#### 결제는 포인트로
우리 서비스는 구매자가 공구에 참여할 때 선불로 결제를 해야 한다. 아이디어 초기에는 신용카드나 다른 간편 결제로 결제하도록 설계했는데, 이를 포인트 제도의 도입으로 사용자가 충전한 포인트로만 선불로 결제하도록 변경했다. 그 이유는 물리적인 외부 API의 사용을 줄이기 위함이었다. 외부 API의 서버에 장애가 생기는 것은 막을 수 없기 때문에, 포인트 제도를 설정하여 사용자의 결제 자체를 Lazy하게 처리하도록 설계했다.

정리하자면,

0. 사용자는 포인트가 충전되어 있음
1. 여러 사용자가 하나의 상품을 공구하기 위해 포인트로 선불 결제함.
2. 사용자 UI에는 포인트가 차감된 것으로 처리되지만, 실제로 돈이 빠져나가진 않음
3. 공구에 진행되면 사용자들의 현금을 가지고 있던 `서비스`가 실제 돈으로 거래를 대행함. (Lazy 처리)

이러한 방식으로 사용자가 외부 API의 사용 횟수를 줄여 의존성을 낮추었다.
하지만 포인트를 충전하는 과정에서는 불가피하게 외부 API를 사용해야 한다. 매 결제마다 외부 API를 사용하는 방식보단 사용 횟수를 줄일 수 있지만, 이러한 관계 마저도 의존성을 낮추고 싶었다.

그 방법으로 2가지 대안이 나왔다.
#### 1. 회원 가입 단계에서 유저의 인증 정보 수집하기
아직 가능한 방법인지 구체적으로 조사하지 않는 상태이지만, 시나리오는 이러하다.

1. 초기 사용자는 회원가입을 진행한다.
2. 회원 가입에는 여러 정보와 함께 결제에 필요한 인증 정보를 동의를 구한 후 입력 및 수집한다.(ex. 지문, 비밀번호 등)
3. 포인트 충전 시 해당 유저의 인증 정보를 대신 활용하여 외부 API의 인증 과정에 대신 처리한다.
4. 이러한 시나리오를 통해, 외부 API의 장애가 발생하여도 사용자게 포인트를 먼저 충전시킬 수 있다. 그리고 결제는 Lazy하게 처리하여 `서비스`에서 대신 결제를 진행한다.

#### 2. 포인트 충전 시 인증 정보를 일시적으로 보관하여 Lazy하게 처리한다.
이 방법은 위 방법과 동일하게 Lazy하게 처리하는 방법이다. 다만 다른 점이 있다면, 사용자 인증 정보를 저장하는 시점과 방식에 차이가 있다.

1. 사용자가 포인트 충전을 시도한다.
2. 외부 API의 장애가 발생한다.
3. 사용자는 지연 처리를 동의하고 사용자 인증 정보를 `서비스`에 일시적으로 제공한다.
4. 외부 API의 장애가 복구되면 사용자 인증 정보를 통해 대신 결제를 진행한다.
5. 사용자의 인증 정보를 폐기한다.

사실, 이러한 시나리오가 불가능하여 무색해질 수 도 있다. 일단, 이러한 아이디어가 가능한지 본격적인 조사가 우선일 듯 하다. 그래도 다행인 점은, 팀 미팅 때 논리적으로 이상할 것도 없고 이론상 충분히 가능할 것 같다는 피드백을 받았다.

아래는 오늘의 Jira 상황
![](https://velog.velcdn.com/images/ehfql6363/post/62834df7-d714-4221-8092-b063894200db/image.png)

초반보다 완료된 task가 늘어서 기분이 좋다.

---
# Use Case - Text
https://season-henley-4a8.notion.site/d1ef6602c34a40b0a68022a43f3c4888?pvs=4
